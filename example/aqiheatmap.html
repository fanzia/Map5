<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<script type="text/javascript" src="../lib/jquery-1.11.1.js"></script>

<script type="text/javascript" src="../lib/GeoBeans.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/BaseTypes/Class.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/BaseTypes/Envelope.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Geometry.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/GeometryCollection.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/Point.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/LineString.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/LinearRing.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/Polygon.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/MultiPoint.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/MultiLineString.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/MultiPolygon.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/GML.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Field.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Feature.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/FeatureType.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Workspace.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/WFS/WFSWorkspace.js"></script>


<script type="text/javascript" src="../lib/GeoBeans/Transformation.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Filter.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/Style.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/Rule.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/Symbolizer.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Layer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/Tile.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/TileCache.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/TileLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/HeatMapLayer.js"></script>
<!--
<script type="text/javascript" src="../lib/GeoBeans/Layer/OsmLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/BaiduLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/BingLayer.js"></script>
-->
<script type="text/javascript" src="../lib/GeoBeans/Layer/AMapLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/QSLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Feature.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/FeatureLayer.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Layer/WMSLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/WFSLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/DBLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/GroupLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/OverlayLayer.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Layer/MapLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/WMSLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/FeatureDBLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/RasterDBLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/PanoramaLayer.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Renderer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Events.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Control.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Control/TrackControl.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Control/DragMapControl.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Control/SrollMapControl.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Control/MapNavControl.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Map.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Filter.js"></script>
<script type="text/javascript" src="../lib/heatmap.min.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/DBS/DBSManager.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/DBS/DataSource.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/DBS/DataSet.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/User.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Poi/PoiManager.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/File/FileManager.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/RasterDB/RasterDBManager.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/RasterDB/Raster.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/TileDB/TileDBManager.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/TileDB/TileStore.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/GPS/GPSManager.js"></script>
<script type="text/javascript">

var mapObj = null;

var countryLayer = null;
var citiesLayer = null;
var aqiLayer = null;
var aqiLayer2 = null;
var heatMapLayer = null;
var userName = "user1";
var mapName = "world"; 
function init(){
	

	var user = new GeoBeans.User(userName);
	var mapManager = user.getMapManager();

	mapObj = mapManager.getMap("mapDiv",mapName);

	if(mapObj == null){
		alert("没有该地图");
		return;
	}
	mapObj.setViewer(mapObj.extent);
	mapObj.setNavControl(false);
	mapObj.draw();
	
	// // 点
	// var symbolizer, rule, style;
	// symbolizer = new GeoBeans.Style.PointSymbolizer();
	// symbolizer.size = 8;
	// symbolizer.fillColor = "Aquamarine";
	// symbolizer.outLineWidth = 1.0;
	// symbolizer.outLineColor = "Red";
	// symbolizer.outLineCap	= GeoBeans.Style.LineCap.ROUND;
	// symbolizer.outLineJoin  = GeoBeans.Style.LineJoin.ROUND;
	// symbolizer.showOutline = true;

	// rule = new GeoBeans.Style.Rule(symbolizer, null);
	// style = new GeoBeans.Style();
	// style.addRule(rule);
	// citiesLayer = new GeoBeans.Layer.WFSLayer("cities",
	// 									"/geoserver/radi/ows?",
	// 									"radi:cities",
	// 									"GML2");
	// citiesLayer.setStyle(style);	
	// // mapObj.addLayer(citiesLayer);

	// symbolizer = new GeoBeans.Style.LineSymbolizer();
	// symbolizer.width = 2;
	// symbolizer.color = "rgba(0,0,255,1)";
	// symbolizer.outLineCap = GeoBeans.Style.LineCap.ROUND;;
	// symbolizer.outLineJoin =  GeoBeans.Style.LineJoin.ROUND;
	// symbolizer.showOutline = true;

	// rule = new GeoBeans.Style.Rule(symbolizer, null);
	// style = new GeoBeans.Style();
	// style.addRule(rule);
	cnProvLayer = new GeoBeans.Layer.WFSLayer("rivers",
										"/geoserver/aqi/ows?",
										"aqi:cn_prov_l",
										"GML2");
	// cnProvLayer.setStyle(style);	
	mapObj.addLayer(cnProvLayer);	

	// 	// 点
	// symbolizer = new GeoBeans.Style.PointSymbolizer();
	// symbolizer.size = 8;
	// symbolizer.fillColor = "Aquamarine";
	// symbolizer.outLineWidth = 1.0;
	// symbolizer.outLineColor = "Red";
	// symbolizer.outLineCap	= GeoBeans.Style.LineCap.ROUND;
	// symbolizer.outLineJoin  = GeoBeans.Style.LineJoin.ROUND;
	// symbolizer.showOutline = true;

	// rule = new GeoBeans.Style.Rule(symbolizer, null);
	// style = new GeoBeans.Style();
	// style.addRule(rule);
	aqiLayer = new GeoBeans.Layer.WFSLayer("cities",
										"/geoserver/aqi/ows?",
										"aqi:gc_aqi_ranking",
										"GML2");
	// aqiLayer.setStyle(style);	
	// var filter = new GeoBeans.Filter("time_point","2015-02-04T08:00:00");
	// aqiLayer.setFilter(filter);
	mapObj.addLayer(aqiLayer);

	
	// mapObj.setViewer(new GeoBeans.Envelope(-180,-90,180,90));
	mapObj.setCenter(center);
	mapObj.setLevel(5);		
	mapObj.draw();	
	heatMapLayer = new GeoBeans.Layer.HeatMapLayer("aqi-map");

}

// function addLayerHeatMap(){
// 	mapObj.removeLayer("aqi-map");
// 	heatMapLayer.setLayer(aqiLayer,"pm2_5");
// 	mapObj.addLayer(heatMapLayer);
// 	// aqiLayer.setVisiable(false);
// 	mapObj.draw();
// }

function timeline(){
	var timelineArray = ["2015-02-04T06:00:00",
		"2015-02-04T07:00:00",
		"2015-02-04T08:00:00",
		"2015-02-04T09:00:00",
		"2015-02-04T10:00:00",
		"2015-02-04T11:00:00",
		"2015-02-04T12:00:00",
		"2015-02-04T13:00:00"
		];

	// aqiLayer.setVisiable(false);
	heatMapLayer.setLayer(aqiLayer,"pm2_5");
	mapObj.addLayer(heatMapLayer);
	mapObj.draw();
	var i = 1;
	// setInterval(function(){
	// 	var time = timelineArray[i];
	// 	var filter = new GeoBeans.Filter("time_point",time);
	// 	aqiLayer.setFilter(filter);
	// 	mapObj.removeLayer("aqi-map");
	// 	heatMapLayer.setLayer(aqiLayer,"pm2_5");
	// 	mapObj.addLayer(heatMapLayer);
	// 	mapObj.draw();
	// 	if(i <　timelineArray.length){
	// 		i++;
	// 	}else{
	// 		i = 0;
	// 	}
	// }
	// 	, 3000);

}

</script>


<title>wfs-aqi-heatmap</title>
</head>

<body onload="init()">
<!-- <canvas id="myCanvas" width="800" height="800"></canvas> -->
	<div id="mapDiv" style="height:800px;width:100%">
	</div>

	<input type="button" value="heatMap" onclick="timeline()">
</body>
</html>




