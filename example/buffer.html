<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<script type="text/javascript" src="../lib/jquery-1.11.1.js"></script>

<script type="text/javascript" src="../lib/GeoBeans.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/BaseTypes/Class.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/BaseTypes/Envelope.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/BaseTypes/Color.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Geometry.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/GeometryCollection.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/Point.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/LineString.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/LinearRing.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/Polygon.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/MultiPoint.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/MultiLineString.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/MultiPolygon.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Geometry/GML.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Field.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Feature.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/FeatureType.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Workspace.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/WFS/WFSWorkspace.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Transformation.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Filter.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Style/StyleManager.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/Style.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/StyleReader.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/StyleWriter.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/Rule.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/FeatureStyle.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/Symbolizer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/PointSymbolizer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/LineSymbolizer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/PolygonSymbolizer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/TextSymbolizer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/Font.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/Stroke.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Style/Fill.js"></script>


<script type="text/javascript" src="../lib/GeoBeans/Layer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/FeatureLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/WFSLayer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Layer/OverlayLayer.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Renderer.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Events.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Control.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Control/TrackControl.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Control/TrackBufferControl.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Control/DragMapControl.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Control/SrollMapControl.js"></script>
<script type="text/javascript" src="../lib/GeoBeans/Control/MapNavControl.js"></script>

<script type="text/javascript" src="../lib/GeoBeans/Map.js"></script>

<script type="text/javascript">

var mapObj = null;
var tracker = null;
var buffer = null;
var citiesLayer = null;
var countryLayer = null;
var riversLayer = null;
function init(){

	mapObj = new GeoBeans.Map("mapDiv");
	mapObj.addEventListener(GeoBeans.Event.MOUSE_MOVE, onMapMove);

	// // 面
	// symbolizer = new GeoBeans.Style.PolygonSymbolizer();
	// symbolizer.size = 8;
	// symbolizer.fillColor = "rgba(0,255,255,1)";
	// symbolizer.outLineWidth = 1.0;
	// symbolizer.outLineColor = "Red";
	// symbolizer.outLineCap	= GeoBeans.Style.LineCap.ROUND;
	// symbolizer.outLineJoin  = GeoBeans.Style.LineJoin.ROUND;
	// symbolizer.showOutline = true;
	
	// rule = new GeoBeans.Style.Rule(symbolizer, null);
	// style = new GeoBeans.Style();
	// style.addRule(rule);
	// countryLayer = new GeoBeans.Layer.WFSLayer("country",
	// 									"/geoserver/radi/ows?",
	// 									"radi:country",
	// 									"GML2");
	// countryLayer.setStyle(style);
	// mapObj.addLayer(countryLayer);	


	// // 线
	// symbolizer = new GeoBeans.Style.LineSymbolizer();
	// symbolizer.width = 2;
	// symbolizer.color = "rgba(0,0,255,1)";
	// symbolizer.outLineCap = GeoBeans.Style.LineCap.ROUND;;
	// symbolizer.outLineJoin =  GeoBeans.Style.LineJoin.ROUND;
	// symbolizer.showOutline = true;

	// rule = new GeoBeans.Style.Rule(symbolizer, null);
	// style = new GeoBeans.Style();
	// style.addRule(rule);
	// riversLayer = new GeoBeans.Layer.WFSLayer("rivers",
	// 									"/geoserver/radi/ows?",
	// 									"radi:rivers",
	// 									"GML2");
	// riversLayer.setStyle(style);	
	// mapObj.addLayer(riversLayer);

	// //点
	// var symbolizer, rule, style;
	// symbolizer = new GeoBeans.Style.PointSymbolizer();
	// symbolizer.size = 8;
	// symbolizer.fillColor = "Aquamarine";
	// symbolizer.outLineWidth = 1.0;
	// symbolizer.outLineColor = "Red";
	// symbolizer.outLineCap	= GeoBeans.Style.LineCap.ROUND;
	// symbolizer.outLineJoin  = GeoBeans.Style.LineJoin.ROUND;
	// symbolizer.showOutline = true;

	// rule = new GeoBeans.Style.Rule(symbolizer, null);
	// style = new GeoBeans.Style();
	// style.addRule(rule);
	// citiesLayer = new GeoBeans.Layer.WFSLayer("cities",
	// 									"/geoserver/radi/ows?",
	// 									"radi:cities",
	// 									"GML2");
	// citiesLayer.setStyle(style);	
	// mapObj.addLayer(citiesLayer);
	citiesLayer = new GeoBeans.Layer.WFSLayer("cities",
										"/ows/user1/world/ims?",
										"cities",
										"GML2");
	countryLayer = new GeoBeans.Layer.WFSLayer("country", "/ows/user1/world/ims?",
										"country",
										"GML2");
	mapObj.addLayer(countryLayer);
	mapObj.addLayer(citiesLayer);
	
	mapObj.setViewer(new GeoBeans.Envelope(-180,-90,180,90));
	mapObj.draw();

}

function onMapMove(evt){
	var mapX = evt.mapX;
	var mapY = evt.mapY;
	
	//var str = mapX + "," + mapY;
	var str = evt.X + "," + evt.Y;
	document.getElementById("xy").innerHTML = str;
}



function onPointBuffer(){
	citiesLayer.queryByBufferCircle(callback_buffer);
}

function onLineBuffer(){
	var distance = 6;

	citiesLayer.queryByBufferLine(distance,callback_buffer);
}

function callback_buffer(features){

	var table = $("#table");
	var html = "";
	for(var i = 0; i < features.length; ++i){
		var feature = features[i];
		var fid = feature.fid;
		html += fid + ";";
	}
	table.html(html);

	// var symbolizer = new GeoBeans.Style.PointSymbolizer();
	// symbolizer.size = 8;
	// symbolizer.fillColor = "#08c";	
	// symbolizer.outLineColor = "#fff";
	// symbolizer.showOutline = true;

	var symbolizer = new GeoBeans.Symbolizer.PointSymbolizer();
	symbolizer.stroke.color.set(255,0,0,1);
	symbolizer.fill.color.set(255,0,0,1);
	symbolizer.size = 12;
	citiesLayer.drawBufferFeatures(features,symbolizer);
}

function removeBuffer(){
	citiesLayer.clearBufferFeatures();
}


function onPointBufferCountry(){
	countryLayer.queryByBufferCircle(callback_buffer_country);
}

function onLineBufferCountry(){
	var distance = 6;
	countryLayer.queryByBufferLine(distance,callback_buffer_country);
}

function callback_buffer_country(features){
	// var	symbolizer = new GeoBeans.Style.PolygonSymbolizer();
	var symbolizer = new GeoBeans.Symbolizer.PolygonSymbolizer();
	symbolizer.fill.color.set(255,0,0,1);
	symbolizer.stroke.color.set(255,0,0,1);
	// symbolizer.showOutline = true;
	countryLayer.drawBufferFeatures(features,symbolizer);
}

function removeBufferCountry(){
	countryLayer.clearBufferFeatures();
}

function onPointBufferRiver(){
	riversLayer.queryByBufferCircle(callback_buffer_rivers);
}

function onLineBufferRiver(){
	var distance = 6;
	riversLayer.queryByBufferLine(distance,callback_buffer_rivers);
}

function removeBufferRiver(){
	riversLayer.clearBufferFeatures();
}

function callback_buffer_rivers(features){
	var symbolizer = new GeoBeans.Style.LineSymbolizer();
	symbolizer.width = 2;
	symbolizer.color = "Red";
	symbolizer.lineCap	= GeoBeans.Style.LineCap.ROUND;
	symbolizer.lineJoin  = GeoBeans.Style.LineJoin.ROUND;
	riversLayer.drawBufferFeatures(features,symbolizer);
}
</script>




<title>Map5-buffer</title>
</head>

<body onload="init()">

<!-- <canvas id="myCanvas" width="800" height="800"></canvas> -->
	<div id="mapDiv" style="height:800px;width:100%">
	</div>

	<div id="xy" style="width:200px;height:30px;line-height:30px" ></div>  
cities:
<input type="button" value="Point Buffer" onclick="onPointBuffer();">
<input type="button" value="Line Buffer" onclick="onLineBuffer();">
<input type="button" value="Remove Buffer" onclick="removeBuffer();">
<br/><br/>
country:
<input type="button" value="Point Buffer" onclick="onPointBufferCountry();">
<input type="button" value="Line Buffer" onclick="onLineBufferCountry();">
<input type="button" value="Remove Buffer" onclick="removeBufferCountry();">
<br/><br/>
river:
<input type="button" value="Point Buffer" onclick="onPointBufferRiver();">
<input type="button" value="Line Buffer" onclick="onLineBufferRiver();">
<input type="button" value="Remove Buffer" onclick="removeBufferRiver();">
<br/>
	<div id="table">
	</div>
</body>
</html>




